<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Booking Form</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { display: block; margin-top: 8px; }
    input, select, button { margin-top: 5px; padding: 6px; width: 200px; }
    .readonly-field { background: #f0f0f0; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h2>Booking Entry</h2>

  <form id="bookingForm">
    <label>Date: <input type="date" id="date"></label>
    <label>Name: <input type="text" id="name"></label>
    <label>Flight No: <input type="text" id="flight"></label>
    <label>Seat No: <input type="text" id="seat"></label>
    <label>Currency:
      <select id="currencyType">
        <option value="USD">USD</option>
        <option value="MVR">MVR</option>
      </select>
    </label>
    <label>Rate:
      <select id="rateType">
        <option value="A">Rate A</option>
        <option value="B">Rate B</option>
      </select>
    </label>
    <label>Adults: <input type="number" id="adultCount" value="0" min="0"></label>
    <label>Kids: <input type="number" id="kidCount" value="0" min="0"></label>
    <label>Payment Type:
      <select id="paymentType">
        <option value="Cash">Cash</option>
        <option value="Card">Card</option>
      </select>
    </label>

    <h3>Totals</h3>
    <label>Total Adults: <input type="text" id="totalAdults" class="readonly-field" readonly></label>
    <label>Total Kids: <input type="text" id="totalKids" class="readonly-field" readonly></label>
    <label>GST: <input type="text" id="gstField" class="readonly-field" readonly></label>
    <label>Total: <input type="text" id="totalField" class="readonly-field" readonly></label>

    <button type="button" id="saveBtn">Save Entry</button>
  </form>

  <div id="output"></div>

  <script>
    const currencyType = document.getElementById("currencyType");
    const rateType = document.getElementById("rateType");
    const adultCount = document.getElementById("adultCount");
    const kidCount = document.getElementById("kidCount");

    const totalAdultsField = document.getElementById("totalAdults");
    const totalKidsField = document.getElementById("totalKids");
    const gstField = document.getElementById("gstField");
    const totalField = document.getElementById("totalField");

    const outputDiv = document.getElementById("output");

    const rates = {
      AdultAUSD: { price: 35.00, GST: 8, WP: "Leeli" },
      KidsAUSD: { price: 25.00, GST: 8, WP: "Leeli" },
      AdultAMVR: { price: 539.10, GST: 8, WP: "Leeli" },
      KidsAMVR: { price: 385.50, GST: 8, WP: "Leeli" },
      AdultBUSD: { price: 24.31, GST: 8, WP: "Leeli" },
      KidsBUSD: { price: 24.31, GST: 8, WP: "Leeli" },
      AdultBMVR: { price: 374.80, GST: 8, WP: "Leeli" },
      KidsBMVR: { price: 374.80, GST: 8, WP: "Leeli" }
    };

    function calculate() {
      const curr = currencyType.value;
      const rate = rateType.value;
      const adults = parseInt(adultCount.value) || 0;
      const kids = parseInt(kidCount.value) || 0;

      const adultKey = `Adult${rate}${curr}`;
      const kidKey = `Kids${rate}${curr}`;

      const adultRate = rates[adultKey].price;
      const kidRate = rates[kidKey].price;
      const gstPercent = rates[adultKey].GST;

      const totalAdults = adults * adultRate;
      const totalKids = kids * kidRate;
      const subtotal = totalAdults + totalKids;
      const gstAmount = subtotal * (gstPercent / 100);
      const total = subtotal + gstAmount;

      // update readonly fields
      totalAdultsField.value = totalAdults.toFixed(2);
      totalKidsField.value = totalKids.toFixed(2);
      gstField.value = gstAmount.toFixed(2);
      totalField.value = total.toFixed(2);

      return { subtotal, gstAmount, total, adultRate, kidRate, gstPercent };
    }

    // Attach live update
    [currencyType, rateType, adultCount, kidCount].forEach(el => {
      el.addEventListener("input", calculate);
      el.addEventListener("change", calculate);
    });

    // Initialize totals
    calculate();

    document.getElementById("saveBtn").addEventListener("click", () => {
      const { subtotal, gstAmount, total, adultRate, kidRate, gstPercent } = calculate();
      outputDiv.innerHTML = `
        <h3>Saved Entry</h3>
        <p><strong>Date:</strong> ${document.getElementById("date").value}</p>
        <p><strong>Name:</strong> ${document.getElementById("name").value}</p>
        <p><strong>Flight No:</strong> ${document.getElementById("flight").value}</p>
        <p><strong>Seat No:</strong> ${document.getElementById("seat").value}</p>
        <p><strong>Adults:</strong> ${adultCount.value} × ${adultRate.toFixed(2)}</p>
        <p><strong>Kids:</strong> ${kidCount.value} × ${kidRate.toFixed(2)}</p>
        <p><strong>Subtotal:</strong> ${subtotal.toFixed(2)}</p>
        <p><strong>GST (${gstPercent}%):</strong> ${gstAmount.toFixed(2)}</p>
        <p><strong>Total:</strong> ${total.toFixed(2)}</p>
        <p><strong>Payment Type:</strong> ${document.getElementById("paymentType").value}</p>
      `;
    });
  </script>
</body>
</html>
