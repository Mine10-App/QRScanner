<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shift Management</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f6f9; margin: 20px; }
    h2 { text-align: center; color: #333; }
    .container { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .shift-box { border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    .shift-header { font-size: 18px; margin-bottom: 10px; }
    .shift-info { margin: 5px 0; }
    .open { color: green; font-weight: bold; }
    .closed { color: red; font-weight: bold; }
    button { margin: 5px; padding: 8px 12px; border: none; border-radius: 6px; cursor: pointer; }
    button:disabled { background: #ddd; cursor: not-allowed; }
    .btn-open { background: #4caf50; color: white; }
    .btn-close { background: #f44336; color: white; }
    #currentShift { text-align: center; font-size: 20px; margin-top: 20px; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
    .modal-content { background: #fff; padding: 20px; border-radius: 8px; text-align: center; }
    .modal input { padding: 8px; margin: 10px 0; width: 80%; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Shift Management</h2>

    <div class="shift-box" id="shift1Box">
      <div class="shift-header">Shift 1 (Morning)</div>
      <div class="shift-info">Status: <span id="shift1Status" class="closed">CLOSED</span></div>
      <div class="shift-info">Open Time: <span id="shift1OpenTime">-</span></div>
      <div class="shift-info">Close Time: <span id="shift1CloseTime">-</span></div>
      <div class="shift-info">Today: <span id="shift1Today">Not opened today</span></div>
      <button class="btn-open" id="shift1OpenBtn">Open Shift 1</button>
      <button class="btn-close" id="shift1CloseBtn" disabled>Close Shift 1</button>
    </div>

    <div class="shift-box" id="shift2Box">
      <div class="shift-header">Shift 2 (Evening)</div>
      <div class="shift-info">Status: <span id="shift2Status" class="closed">CLOSED</span></div>
      <div class="shift-info">Open Time: <span id="shift2OpenTime">-</span></div>
      <div class="shift-info">Close Time: <span id="shift2CloseTime">-</span></div>
      <div class="shift-info">Today: <span id="shift2Today">Not opened today</span></div>
      <button class="btn-open" id="shift2OpenBtn">Open Shift 2</button>
      <button class="btn-close" id="shift2CloseBtn" disabled>Close Shift 2</button>
    </div>

    <div id="currentShift">No shift active</div>
  </div>

  <!-- Supervisor Password Modal -->
  <div class="modal" id="passwordModal">
    <div class="modal-content">
      <h3>Supervisor Approval Required</h3>
      <p id="modalAction"></p>
      <input type="password" id="supervisorPassword" placeholder="Enter password">
      <br>
      <button onclick="submitPassword()">Submit</button>
      <button onclick="closeModal()">Cancel</button>
    </div>
  </div>

  <script>
    const SUPERVISOR_PASSWORD = "1234"; // change to real password

    let state = {
      shifts: {
        shift1: { open: false, openTime: null, closeTime: null, openedToday: false, closedToday: false, name: "Shift 1" },
        shift2: { open: false, openTime: null, closeTime: null, openedToday: false, closedToday: false, name: "Shift 2" }
      },
      pendingAction: null
    };

    const elements = {
      shift1Status: document.getElementById("shift1Status"),
      shift1OpenTime: document.getElementById("shift1OpenTime"),
      shift1CloseTime: document.getElementById("shift1CloseTime"),
      shift1Today: document.getElementById("shift1Today"),
      shift1OpenBtn: document.getElementById("shift1OpenBtn"),
      shift1CloseBtn: document.getElementById("shift1CloseBtn"),
      shift2Status: document.getElementById("shift2Status"),
      shift2OpenTime: document.getElementById("shift2OpenTime"),
      shift2CloseTime: document.getElementById("shift2CloseTime"),
      shift2Today: document.getElementById("shift2Today"),
      shift2OpenBtn: document.getElementById("shift2OpenBtn"),
      shift2CloseBtn: document.getElementById("shift2CloseBtn"),
      currentShift: document.getElementById("currentShift"),
      passwordModal: document.getElementById("passwordModal"),
      supervisorPassword: document.getElementById("supervisorPassword"),
      modalAction: document.getElementById("modalAction")
    };

    // Utility
    function formatTime(date) {
      if (!date) return "-";
      return date.toLocaleTimeString();
    }

    // Modal
    function showPasswordModal(shiftId, action) {
      state.pendingAction = { shiftId, action };
      elements.modalAction.textContent = `Supervisor approval required to ${action} ${state.shifts[shiftId].name}`;
      elements.supervisorPassword.value = "";
      elements.passwordModal.style.display = "flex";
    }
    function closeModal() { elements.passwordModal.style.display = "none"; }
    function submitPassword() {
      if (elements.supervisorPassword.value === SUPERVISOR_PASSWORD) {
        const { shiftId, action } = state.pendingAction;
        if (action === "open") openShift(shiftId);
        else closeShift(shiftId);
        closeModal();
      } else {
        alert("Incorrect password!");
      }
    }

    // Open shift
    function handleOpenShift(shiftId) {
      const shift = state.shifts[shiftId];

      if (shiftId === "shift2" && !state.shifts.shift1.closedToday) {
        alert("You must complete Shift 1 before opening Shift 2.");
        return;
      }

      if (shift.open) {
        alert(`${shift.name} is already open!`);
        return;
      }

      if (shift.openedToday) {
        showPasswordModal(shiftId, "open");
        return;
      }

      openShift(shiftId);
    }

    function openShift(shiftId) {
      const shift = state.shifts[shiftId];
      shift.open = true;
      shift.openTime = new Date();
      shift.openedToday = true;
      updateUI();
    }

    // Close shift
    function handleCloseShift(shiftId) {
      const shift = state.shifts[shiftId];

      if (!shift.open) {
        alert(`${shift.name} is not open!`);
        return;
      }

      if (shift.closedToday) {
        showPasswordModal(shiftId, "close");
        return;
      }

      closeShift(shiftId);
    }

    function closeShift(shiftId) {
      const shift = state.shifts[shiftId];
      shift.open = false;
      shift.closeTime = new Date();
      shift.closedToday = true;
      updateUI();
    }

    // UI update
    function updateUI() {
      // Shift 1
      if (state.shifts.shift1.open) {
        elements.shift1Status.textContent = "OPEN";
        elements.shift1Status.className = "shift-info open";
        elements.shift1OpenBtn.disabled = true;
        elements.shift1CloseBtn.disabled = false;
      } else {
        elements.shift1Status.textContent = "CLOSED";
        elements.shift1Status.className = "shift-info closed";
        elements.shift1OpenBtn.disabled = state.shifts.shift1.openedToday;
        elements.shift1CloseBtn.disabled = true;
      }

      // Shift 2
      if (state.shifts.shift2.open) {
        elements.shift2Status.textContent = "OPEN";
        elements.shift2Status.className = "shift-info open";
        elements.shift2OpenBtn.disabled = true;
        elements.shift2CloseBtn.disabled = false;
      } else {
        elements.shift2Status.textContent = "CLOSED";
        elements.shift2Status.className = "shift-info closed";
        elements.shift2OpenBtn.disabled = !state.shifts.shift1.closedToday || state.shifts.shift2.openedToday;
        elements.shift2CloseBtn.disabled = true;
      }

      // Times
      elements.shift1OpenTime.textContent = formatTime(state.shifts.shift1.openTime);
      elements.shift1CloseTime.textContent = formatTime(state.shifts.shift1.closeTime);
      elements.shift2OpenTime.textContent = formatTime(state.shifts.shift2.openTime);
      elements.shift2CloseTime.textContent = formatTime(state.shifts.shift2.closeTime);

      // Today summary
      elements.shift1Today.textContent = state.shifts.shift1.openedToday ?
        (state.shifts.shift1.closedToday ? "Opened and closed today" : "Opened today") : "Not opened today";

      elements.shift2Today.textContent = state.shifts.shift2.openedToday ?
        (state.shifts.shift2.closedToday ? "Opened and closed today" : "Opened today") : "Not opened today";

      // Current shift indicator
      if (state.shifts.shift1.open) {
        elements.currentShift.textContent = "Current Shift: Shift 1 (Morning)";
      } else if (state.shifts.shift2.open) {
        elements.currentShift.textContent = "Current Shift: Shift 2 (Evening)";
      } else {
        elements.currentShift.textContent = "No shift active";
      }
    }

    // Button listeners
    elements.shift1OpenBtn.addEventListener("click", () => handleOpenShift("shift1"));
    elements.shift1CloseBtn.addEventListener("click", () => handleCloseShift("shift1"));
    elements.shift2OpenBtn.addEventListener("click", () => handleOpenShift("shift2"));
    elements.shift2CloseBtn.addEventListener("click", () => handleCloseShift("shift2"));

    updateUI();
  </script>
</body>
</html>
